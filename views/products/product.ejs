<% include ('../usersidepartials/header')%>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/themify-icons/0.1.2/css/themify-icons.min.css"
        integrity="sha384-XXXXXX" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    <link rel="stylesheet" href="/img/favicon.png">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/css/usercss/bootstrap.min.css">
    <!-- animate CSS -->
    <link rel="stylesheet" href="/css/usercss/animate.css">
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="/css/usercss/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/usercss/lightslider.min.css">
    <!-- font awesome CSS -->
    <link rel="stylesheet" href="/css/usercss/all.css">
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="/css/usercss/flaticon.css">
   
    <link rel="stylesheet" href="/css/usercss/themify-icons.css">
   
    <link rel="stylesheet" href="/css/usercss/magnific-popup.css">
    <!-- style CSS -->
    <link rel="stylesheet" href="/css/usercss/style.css">
    <title>aranoz|<%=product.name%></title>

   
        <!--::header part start::-->
        <header class="main_menu home_menu">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-12">
                        <nav class="navbar navbar-expand-lg navbar-light">
                            <a class="navbar-brand" href="index.html"> <img src="/img/logo.png" alt="logo"> </a>
                            <button class="navbar-toggler" type="button" data-toggle="collapse"
                                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                                aria-expanded="false" aria-label="Toggle navigation">
                                <span class="menu_icon"><i class="fas fa-bars"></i></span>
                            </button>

                            <div class="collapse navbar-collapse main-menu-item" id="navbarSupportedContent">
                                <ul class="navbar-nav">
                                    <li class="nav-item">
                                        <a class="nav-link" href="/home">Home</a>
                                    </li>
                                    <li class="nav-item dropdown">
                                        <a class="nav-link dropdown-toggle" href="blog.html" id="navbarDropdown_1"
                                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            Shop
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="navbarDropdown_1">
                                            <a class="dropdown-item" href="/home/shopcategory"> shop category</a>
                                            
                                        </div>
                                    </li>
                                    <% if(userSession) {%>
                                        <li class="nav-item dropdown">
                                            <a class="nav-link dropdown-toggle" href="blog.html" id="navbarDropdown_3"
                                                role="button" data-toggle="dropdown" aria-haspopup="true"
                                                aria-expanded="false">
                                                Profile
                                            </a>
                                            <div class="dropdown-menu" aria-labelledby="navbarDropdown_2">
                                                <a class="dropdown-item" href="/user/dashboard/profile"> Profile</a>
                                                <a class="dropdown-item" href="/user/dashboard/profile/address">Address</a>
                                                <a class="dropdown-item" href="/user/dashboard/profile/wishlist">Wishlist </a>
                                                <a class="dropdown-item" href="/user/dashboard/profile/wallet">Wallet</a>
                                                <a class="dropdown-item" href="/user/dashboard/profile/orders">Orders</a>
                                                <a class="dropdown-item" onclick="logout()">Logout</a>
                                               
                                            </div>
                                        </li>
                                    <%}%>
                                   

                                    <li class="nav-item">
                                        <a class="nav-link" href="/contact">Contact</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="hearer_icon d-flex">
                                <a id="search_1" href="javascript:void(0)"><i class="bi bi-search"></i></a>
                                <a href=""><i class="bi bi-heart"></i></a>
                                <div >
                                    <a href="/user/cart">
                                        <i class="bi bi-cart"></i>
                                    </a>
                                    

                                </div>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="search_input" id="search_input_box">
                <div class="container ">
                    <form class="d-flex justify-content-between search-inner">
                        <input type="text" class="form-control" id="search_input" placeholder="Search Here">
                        <button type="submit" class="btn"></button>
                        <span class="ti-close" id="close_search" title="Close Search"></span>
                    </form>
                </div>
            </div>
        </header>
        <!-- Header part end-->

        <!-- breadcrumb start-->
        <section class="breadcrumb breadcrumb_bg">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="breadcrumb_iner">
                            <div class="breadcrumb_iner_item">
                                <h2>Shop Single</h2>
                                <h1><%=pageTitle%></h1>
                                <p>
                                    <% breadcrumbItems.forEach(function(item, index) { %>
                                        <% if (item.url) { %>
                                            <a href="<%= item.url %>"><%= item.name %></a>
                                        <% } else { %>
                                            <%= item.name %>
                                        <% } %>
                                        <% if (index < breadcrumbItems.length - 1) { %>
                                            <span> - </span>
                                        <% } %>
                                    <% }) %>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- breadcrumb start-->
        <!--================End Home Banner Area =================-->

        <!--================Single Product Area =================-->
        <div class="product_image_area section_padding">
            <div class="container">
                <div class="row s_product_inner justify-content-between">
                    <div class="col-lg-7 col-xl-7">
                        <div class="product_slider_img">
                            <div id="vertical">
                               
                                <% product.imageUrl.forEach(function (image){%>
                                    <div  data-thumb="<%=image%>">
                                        <div class="productImage">
                                            <img class="image"  src="<%=image%>" />
                                        </div>
                                    </div>
                                    <%})%>
                              
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-5 col-xl-4">
                        <div class="s_product_text">
                           
                            <h3>
                                <%=product.name%>
                            </h3>
                            <%if(product.discountPercentage){%>
                                <h2 style="display: inline;">₹<%=product.discountPercentage%></h2>
                                <h2 style="text-decoration: line-through;display: inline;margin-left: 65px;">₹<%=product.price%>
                                </h2>
                                <%}else{%>
                                    <h2 style="display: inline;">₹<%=product.price%>
                                    </h2>
                                    <%}%>
                            
                            <ul class="list">
                                <li>
                                    <a class="active" href="#">
                                        <span>Category</span> : <%=product.category.name%></a>
                                </li>
                                <li>
                                    <a href="#">
                                        <span>Availability</span> : <%= product.stock > 0 ? 'In stock' : 'Out of stock' %>
                                    </a>
                                    
                                </li>
                            </ul>
                            <p>
                                    <%=category.description%>   
                            </p>
                            <div class="card_area d-flex justify-content-between align-items-center">
                              

                                <%if(!product.stock==0 && user){%>
                                    <a  onclick="addToCart('<%=product._id%>')" class="btn_3">add to cart</a>
                                    <a  onclick="addToWishlist('<%=product._id%>')" class="like_us d-flex justify-content-center align-items-center">
                                        <i class="bi bi-heart-fill"></i>
                                    </a>
                                    <%}else if(!user){%>
                                        <a href="/user/login" class="btn_3">add to cart</a>  
                                        <%}else if(user){%>
                                            <a  onclick="addToWishlist('<%=product._id%>')" class="like_us d-flex justify-content-center align-items-center">
                                                <i class="bi bi-heart-fill"></i>
                                            </a>
                                            <%}%>
                                

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--================End Single Product Area =================-->

        <!--================Product Description Area =================-->
        <section class="product_description_area">
            <div class="container">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                   
                    <li class="nav-item">
                        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab"
                            aria-controls="profile" aria-selected="false">Specification</a>
                    </li>
                   
                   
                </ul>
                <div class="tab-content" id="myTabContent">
                    
                    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                        <div class="table-responsive">
                            <table class="table">
                               <% if(product.specifications){ %>
                                <tbody>
                                   <% product.specifications.forEach(spec=>{%>
                                    <tr>
                                        <td>
                                            <h5><%=spec.key%></h5>
                                        </td>
                                        <td>
                                            <h5><%=spec.value%></spec.value></h5>
                                        </td>
                                    </tr><%})%>
                                </tbody><%}%>
                                   
                                
                            </table>
                        </div>
                    </div>
                   
                   
                </div>
            </div>
        </section>
        <!--================End Product Description Area =================-->

        <!-- product_list part start-->
        <section class="product_list best_seller">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-12">
                        <div class="section_tittle text-center">
                            <h2>Best Sellers <span>shop</span></h2>
                        </div>
                    </div>
                </div>
                <div class="row align-items-center justify-content-between">
                    <div class="col-lg-12">
                        <div class="best_product_slider owl-carousel">
                            
                                <%products.forEach(product =>{%>
                                    <div class="single_product_item">
                                        <a href="/user/product/<%=product._id%>">
                                            <img src="<%=product.imageUrl[0]%>" alt="">
                                        <div class="single-product_text">
                                            <h4><%=product.name%></h4>

                                            <h3><%=product.price%></h3>
                                        </div>
                                        </a>
                                    </div>
                            
                            <%})%>
                          
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- product_list part end-->

        <!--::footer_part start::-->
        <footer class="footer_part">
            <div class="container">
                <div class="row justify-content-around">
                    <div class="col-sm-6 col-lg-2">
                        <div class="single_footer_part">
                            <h4>Top Products</h4>
                            <ul class="list-unstyled">
                                <li><a href="">Managed Website</a></li>
                                <li><a href="">Manage Reputation</a></li>
                                <li><a href="">Power Tools</a></li>
                                <li><a href="">Marketing Service</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-2">
                        <div class="single_footer_part">
                            <h4>Quick Links</h4>
                            <ul class="list-unstyled">
                                <li><a href="">Jobs</a></li>
                                <li><a href="">Brand Assets</a></li>
                                <li><a href="">Investor Relations</a></li>
                                <li><a href="">Terms of Service</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-2">
                        <div class="single_footer_part">
                            <h4>Features</h4>
                            <ul class="list-unstyled">
                                <li><a href="">Jobs</a></li>
                                <li><a href="">Brand Assets</a></li>
                                <li><a href="">Investor Relations</a></li>
                                <li><a href="">Terms of Service</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-2">
                        <div class="single_footer_part">
                            <h4>Resources</h4>
                            <ul class="list-unstyled">
                                <li><a href="">Guides</a></li>
                                <li><a href="">Research</a></li>
                                <li><a href="">Experts</a></li>
                                <li><a href="">Agencies</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-sm-6 col-lg-4">
                        <div class="single_footer_part">
                            <h4>Newsletter</h4>
                            <p>Heaven fruitful doesn't over lesser in days. Appear creeping
                            </p>
                            <div id="mc_embed_signup">
                                <form target="_blank"
                                    action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                    method="get" class="subscribe_form relative mail_part">
                                    <input type="email" name="email" id="newsletter-form-email"
                                        placeholder="Email Address" class="placeholder hide-on-focus"
                                        onfocus="this.placeholder = ''" onblur="this.placeholder = ' Email Address '">
                                    <button type="submit" name="submit" id="newsletter-submit"
                                        class="email_icon newsletter-submit button-contactForm">subscribe</button>
                                    <div class="mt-10 info"></div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="copyright_part">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-8">
                            <div class="copyright_text">
                                <P><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                                    Copyright &copy;
                                    <script>document.write(new Date().getFullYear());</script> All rights reserved |
                                    This template is made with <i class="ti-heart" aria-hidden="true"></i> by <a
                                        href="https://colorlib.com" target="_blank">Colorlib</a>
                                    <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                                </P>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="footer_icon social_icon">
                                <ul class="list-unstyled">
                                    <li><a href="#" class="single_social_icon"><i class="fab fa-facebook-f"></i></a>
                                    </li>
                                    <li><a href="#" class="single_social_icon"><i class="fab fa-twitter"></i></a></li>
                                    <li><a href="#" class="single_social_icon"><i class="fas fa-globe"></i></a></li>
                                    <li><a href="#" class="single_social_icon"><i class="fab fa-behance"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!--::footer_part end::-->
        
        <script>
           
    document.addEventListener('DOMContentLoaded', () => {
        const images = document.querySelectorAll('.image');

        images.forEach(image => {
            const container = image.closest('.container'); 

            image.addEventListener('mousemove', (event) => {
                const rect = container.getBoundingClientRect(); 
                const x = event.clientX - rect.left; 
                const y = event.clientY - rect.top;

                image.style.transformOrigin = `${x}px ${y}px`;
                image.style.transform = "scale(2)";
            });

            image.addEventListener('mouseleave', () => {
                image.style.transform = "scale(1)";
            });
        });
    });
</script>
        <script>
           async function logout(){
            console.log('button has clicked')
               try{
                const response=await fetch('/user/logout',{
                    method:'POST',
                    headers:{
                        'Content-Type':'application/json'
                    }
                })

                if(response.ok){
                    const result=await response.json()
                    Swal.fire({
                        title:'success',
                        text:result.message,
                        icon:'success',
                        confirmButtonText:'OK'
                    }).then(()=>{
                        window.location.href='/home'
                    })
                }
                else{
                    const result=await response.json()
                    Swal.fire({
                        title:'failed',
                        text:result.message
                    })
                }
               }catch(err){
                console.error('error occured in logout',err)

               }
            }
        </script>
         <script>
            async function addToCart(productId){
                try {
                            const response = await fetch(`/user/dashboard/addtocart/${productId}`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                            });
                            if (response.ok) {
                                const result = await response.json();
                                Swal.fire({
                                    title: 'Success',
                                    text: result.message,
                                    icon: 'success',
                                    confirmButtonText: 'OK'
                                });
                            } else {
                                const result = await response.json();
                                Swal.fire({
                                    title: 'Failed',
                                    text: result.message,
                                    icon: 'error',
                                    confirmButtonText: 'OK'
                                });
                            }
                        } catch (err) {
                            console.error(err);
                        }
            }
            async function addToWishlist(productId){
           try{
            const response=await fetch('/user/dashboard/add-to-wishlist',{
                method:'POST',
                headers:{
                    'Content-Type':'application/json'
                },
                body:JSON.stringify({productId})
            })
            const result=await response.json()
            if(response.ok){
                console.log('successfully added to wishlist')
                Swal.fire({
                    title:'success',
                    text:result.message,
                    icon:'success',
                    confirmButtonText:'OK'
                })
            }else{
                if(response.status===409){
                    Swal.fire({
                    title:'warning',
                    text:result.message,
                    icon:'warning',
                    confirmButtonText:'OK'
                })
                }
            }
           }catch(err){
            console.error(err)
           }
        }
        </script>
        <!-- jquery plugins here-->
        <!-- jquery -->
        <!-- <script src="/js/jquery-1.12.1.min.js"></script> -->
        <script src="/js/jquery-1.12.1.min.js"></script>
        <!-- popper js -->
        <!-- <script src="js/popper.min.js"></script> -->
        <script src="/js/popper.min.js"></script>
        <!-- bootstrap js -->
        <!-- <script src="js/bootstrap.min.js"></script> -->
        <script src="/js/bootstrap.min.js"></script>
        <!-- easing js -->
        <!-- <script src="js/jquery.magnific-popup.js"></script> -->
        <script src="/js/jquery.magnific-popup.js"></script>
        <!-- swiper js -->
        <!-- <script src="js/lightslider.min.js"></script> -->
        <script src="/js/lightslider.min.js"></script>
        <!-- swiper js -->
        <!-- <script src="js/masonry.pkgd.js"></script> -->
        <script src="/js/masonry.pkgd.js"></script>
        <!-- particles js -->
        <!-- <script src="js/owl.carousel.min.js"></script> -->
        <script src="/js/owl.carousel.min.js"></script>
        <!-- <script src="js/jquery.nice-select.min.js"></script> -->
        <script src="/js/jquery.nice-select.min.js"></script>
        <!-- slick js -->
        <!-- <script src="js/slick.min.js"></script> -->
        <script src="/js/slick.min.js"></script>
        <!-- <script src="js/swiper.jquery.js"></script> -->
        <script src="/js/swiper.jquery.js"></script>
        <!-- <script src="js/jquery.counterup.min.js"></script> -->
        <script src="/js/jquery.counterup.min.js"></script>
        <!-- <script src="js/waypoints.min.js"></script> -->
        <script src="/js/waypoints.min.js"></script>
        <!-- <script src="js/contact.js"></script> -->
        <script src="/js/contact.js"></script>
        <!-- <script src="js/jquery.ajaxchimp.min.js"></script> -->
        <script src="/js/jquery.ajaxchimp.min.js"></script>
        <!-- <script src="js/jquery.form.js"></script> -->
        <script src="/js/jquery.form.js"></script>
        <!-- <script src="js/jquery.validate.min.js"></script> -->
        <script src="/js/jquery.validate.min.js"></script>
        <!-- <script src="js/mail-script.js"></script> -->
        <script src="/js/mail-script.js"></script>
        <!-- <script src="js/stellar.js"></script> -->
        <script src="/js/stellar.js"></script>
        <!-- custom js -->
        <!-- <script src="js/theme.js"></script> -->
        <script src="/js/theme.js"></script>
        <!-- <script src="js/custom.js"></script> -->
        <script src="/js/custom.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>


        <% include ('../usersidepartials/footer')%>